<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<body>
    <!-- Generic Stats Card Component -->
    <div th:fragment="stats-card(title, endpoint, refreshable)" id="stats-card"
         class="bg-white rounded-lg shadow border border-gray-200">
        <div class="flex items-center justify-between px-6 py-4 border-b border-gray-200">
            <div class="flex items-center space-x-3">
                <svg class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z" />
                </svg>
                <h2 class="text-lg font-medium text-gray-900" th:text="${title}">Statistics</h2>
            </div>
            <button th:if="${refreshable}"
                class="inline-flex items-center px-3 py-1.5 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"
                th:attr="hx-get=${endpoint}"
                hx-headers='{"Content-Type": "application/json"}'
                hx-indicator="#stats-spinner"
                hx-swap="innerHTML transition:true"
                hx-trigger="click" 
                hx-target="#stats-content"
                title="Refresh statistics">
                <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99" />
                </svg>
            </button>
        </div>
        <div class="p-6">
            <div id="stats-content"
                 th:if="${endpoint != null}"
                 th:attr="hx-get=${endpoint}"
                 hx-headers='{"Content-Type": "application/json"}'
                 hx-indicator="#stats-spinner"
                 hx-swap="innerHTML transition:true"
                 hx-trigger="load">
                <!-- Initial loading state -->
                <div class="flex justify-center py-4">
                    <img alt="Loading..." class="h-8 w-8" src="https://htmx.org/img/bars.svg"/>
                </div>
            </div>
            <div th:if="${endpoint != null}" class="flex justify-center py-4 htmx-indicator" id="stats-spinner">
                <img alt="Loading..." class="h-8 w-8" src="https://htmx.org/img/bars.svg"/>
            </div>
            <div th:if="${endpoint == null}">
                <slot></slot>
            </div>
        </div>
    </div>
</body>
</html> 